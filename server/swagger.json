{
  "openapi": "3.0.0",
  "info": {
    "title": "易宿酒店预订平台 API",
    "version": "1.0.0",
    "description": "基于 Node.js Express 的酒店预订系统后端接口文档"
  },
  "servers": [
    {
      "url": "http://localhost:5000",
      "description": "本地开发服务器"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "User": {
        "type": "object",
        "required": [
          "username",
          "password",
          "role"
        ],
        "properties": {
          "username": {
            "type": "string",
            "example": "merchant_01"
          },
          "password": {
            "type": "string",
            "example": "password123",
            "description": "加密存储"
          },
          "role": {
            "type": "string",
            "enum": [
              "user",
              "merchant",
              "admin"
            ],
            "default": "user",
            "example": "merchant"
          },
          "gender": {
            "type": "string",
            "enum": [
              "male",
              "female",
              "unknown"
            ],
            "default": "unknown",
            "example": "male"
          },
          "avatar": {
            "type": "string",
            "example": "/uploads/avatars/default.png"
          },
          "bio": {
            "type": "string",
            "example": "热爱旅行"
          }
        }
      },
      "Hotel": {
        "type": "object",
        "required": [
          "merchantId",
          "name",
          "city",
          "address",
          "starRating",
          "price"
        ],
        "properties": {
          "merchantId": {
            "type": "string",
            "description": "关联商户ID",
            "example": "609c1..."
          },
          "name": {
            "type": "string",
            "example": "上海中心J酒店"
          },
          "nameEn": {
            "type": "string",
            "example": "J Hotel Shanghai Tower"
          },
          "city": {
            "type": "string",
            "example": "上海"
          },
          "address": {
            "type": "string",
            "example": "上海市浦东新区东泰路126号"
          },
          "starRating": {
            "type": "integer",
            "minimum": 1,
            "maximum": 5,
            "example": 5
          },
          "score": {
            "type": "number",
            "description": "综合评分 (自动计算)",
            "example": 4.8
          },
          "price": {
            "type": "number",
            "description": "起始价格",
            "example": 9999
          },
          "openingTime": {
            "type": "string",
            "example": "2021年"
          },
          "location": {
            "type": "object",
            "required": [
              "type",
              "coordinates"
            ],
            "properties": {
              "type": {
                "type": "string",
                "default": "Point",
                "example": "Point"
              },
              "coordinates": {
                "type": "array",
                "items": {
                  "type": "number"
                },
                "description": "[经度(Lng), 纬度(Lat)] - 注意顺序！",
                "example": [
                  121.505,
                  31.233
                ]
              }
            }
          },
          "description": {
            "type": "string",
            "example": "云端体验"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "example": [
              "地标",
              "奢华"
            ]
          },
          "images": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "example": [
              "/uploads/hotel1.jpg"
            ]
          },
          "nearbyAttractions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "附近热门景点",
            "example": [
              "故宫",
              "天安门广场",
              "王府井"
            ]
          },
          "nearbyTransport": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "交通信息",
            "example": [
              "地铁1号线王府井站步行5分钟",
              "首都机场30公里"
            ]
          },
          "nearbyMalls": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "附近商场",
            "example": [
              "王府井百货",
              "东方新天地"
            ]
          },
          "status": {
            "type": "integer",
            "enum": [
              0,
              1,
              2,
              3
            ],
            "description": "0:待审核, 1:已发布, 2:拒绝, 3:下线",
            "default": 0
          },
          "rejectReason": {
            "type": "string",
            "example": "图片不清晰"
          }
        }
      },
      "RoomType": {
        "type": "object",
        "required": [
          "hotelId",
          "title",
          "price",
          "stock"
        ],
        "properties": {
          "hotelId": {
            "type": "string",
            "description": "关联酒店ID",
            "example": "609c1..."
          },
          "title": {
            "type": "string",
            "example": "云端大床房"
          },
          "price": {
            "type": "number",
            "description": "实际价格 (平日基准价)",
            "example": 5000
          },
          "originalPrice": {
            "type": "number",
            "description": "原价(可选)",
            "example": 8888
          },
          "capacity": {
            "type": "integer",
            "default": 2,
            "example": 2
          },
          "bedInfo": {
            "type": "string",
            "example": "1张2米特大床"
          },
          "size": {
            "type": "string",
            "example": "60m²"
          },
          "stock": {
            "type": "integer",
            "description": "库存 (必填)",
            "example": 10
          },
          "images": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "example": [
              "/uploads/room1.jpg"
            ]
          },
          "priceCalendar": {
            "type": "array",
            "description": "特定日期价格日历",
            "items": {
              "type": "object",
              "properties": {
                "date": {
                  "type": "string",
                  "format": "date",
                  "example": "2026-05-01"
                },
                "price": {
                  "type": "number",
                  "example": 6000
                },
                "stock": {
                  "type": "integer",
                  "example": 5
                }
              }
            }
          }
        }
      },
      "Order": {
        "type": "object",
        "required": [
          "userId",
          "hotelId",
          "roomTypeId",
          "checkInDate",
          "checkOutDate",
          "totalPrice"
        ],
        "properties": {
          "userId": {
            "type": "string",
            "description": "下单用户ID",
            "example": "user_123"
          },
          "hotelId": {
            "type": "string",
            "example": "hotel_456"
          },
          "roomTypeId": {
            "type": "string",
            "example": "room_789"
          },
          "checkInDate": {
            "type": "string",
            "format": "date",
            "example": "2023-10-01"
          },
          "checkOutDate": {
            "type": "string",
            "format": "date",
            "example": "2023-10-03"
          },
          "quantity": {
            "type": "integer",
            "default": 1,
            "example": 1
          },
          "totalPrice": {
            "type": "number",
            "example": 2000
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "paid",
              "completed",
              "cancelled"
            ],
            "default": "pending",
            "example": "paid"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Review": {
        "type": "object",
        "required": [
          "hotelId",
          "rating",
          "content"
        ],
        "properties": {
          "userId": {
            "type": "string",
            "description": "用户ID (GET列表中会填充为包含头像用户名的对象)",
            "example": "user_123"
          },
          "hotelId": {
            "type": "string",
            "example": "hotel_456"
          },
          "rating": {
            "type": "integer",
            "minimum": 1,
            "maximum": 5,
            "example": 5
          },
          "content": {
            "type": "string",
            "example": "非常棒的体验！"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Favorite": {
        "type": "object",
        "required": [
          "userId",
          "hotelId"
        ],
        "properties": {
          "userId": {
            "type": "string",
            "example": "user_123"
          },
          "hotelId": {
            "type": "string",
            "description": "GET列表接口中会填充为完整的 Hotel 对象",
            "example": "hotel_456"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Banner": {
        "type": "object",
        "required": [
          "imageUrl",
          "targetHotelId"
        ],
        "properties": {
          "imageUrl": {
            "type": "string",
            "example": "/uploads/banner1.jpg"
          },
          "targetHotelId": {
            "type": "string",
            "description": "关联酒店ID",
            "example": "654321..."
          },
          "title": {
            "type": "string",
            "example": "五一特惠活动"
          },
          "priority": {
            "type": "integer",
            "default": 0,
            "example": 10
          },
          "status": {
            "type": "integer",
            "default": 1,
            "example": 1
          }
        }
      },
      "Announcement": {
        "type": "object",
        "required": [
          "title",
          "content"
        ],
        "properties": {
          "_id": {
            "type": "string",
            "example": "60a1b..."
          },
          "title": {
            "type": "string",
            "example": "系统升级通知"
          },
          "content": {
            "type": "string",
            "example": "系统将于今晚22:00进行升级维护..."
          },
          "type": {
            "type": "string",
            "enum": [
              "info",
              "success",
              "warning"
            ],
            "default": "info",
            "example": "info"
          },
          "status": {
            "type": "integer",
            "enum": [
              0,
              1
            ],
            "default": 1,
            "description": "0: 下线, 1: 上线",
            "example": 1
          },
          "createdBy": {
            "type": "string",
            "description": "创建者用户ID",
            "example": "609c1..."
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Message": {
        "type": "object",
        "required": [
          "conversationId",
          "senderId",
          "receiverId",
          "content"
        ],
        "properties": {
          "_id": {
            "type": "string",
            "example": "60a1b..."
          },
          "conversationId": {
            "type": "string",
            "description": "会话ID，由双方用户ID生成",
            "example": "user123_user456"
          },
          "senderId": {
            "type": "string",
            "description": "发送者用户ID",
            "example": "609c1..."
          },
          "receiverId": {
            "type": "string",
            "description": "接收者用户ID",
            "example": "609c2..."
          },
          "content": {
            "type": "string",
            "description": "消息内容",
            "example": "您好，请问有什么可以帮您？"
          },
          "type": {
            "type": "string",
            "enum": [
              "text",
              "image"
            ],
            "default": "text",
            "example": "text"
          },
          "read": {
            "type": "boolean",
            "default": false,
            "example": false
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Promotion": {
        "type": "object",
        "required": [
          "hotelId",
          "title",
          "type",
          "discountValue",
          "startDate",
          "endDate"
        ],
        "properties": {
          "_id": {
            "type": "string",
            "example": "60a1b..."
          },
          "hotelId": {
            "type": "string",
            "description": "所属酒店ID",
            "example": "609c1..."
          },
          "title": {
            "type": "string",
            "description": "促销标题",
            "example": "国庆特惠"
          },
          "description": {
            "type": "string",
            "example": "国庆期间全场8折"
          },
          "type": {
            "type": "string",
            "enum": [
              "discount",
              "amount_off",
              "fixed_price"
            ],
            "description": "discount:折扣, amount_off:满减, fixed_price:特价"
          },
          "discountValue": {
            "type": "number",
            "description": "折扣值(如0.8) / 满减额 / 特价",
            "example": 0.8
          },
          "minAmount": {
            "type": "number",
            "description": "满减门槛",
            "default": 0
          },
          "roomTypes": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "适用房型ID，空表示全部"
          },
          "startDate": {
            "type": "string",
            "format": "date"
          },
          "endDate": {
            "type": "string",
            "format": "date"
          },
          "status": {
            "type": "integer",
            "enum": [
              0,
              1
            ],
            "default": 1,
            "description": "0:下线, 1:上线"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      }
    }
  },
  "paths": {
    "/api/health": {
      "get": {
        "summary": "健康检查",
        "description": "检查系统健康状态，用于负载均衡器和监控系统",
        "tags": [
          "System"
        ],
        "responses": {
          "200": {
            "description": "系统健康",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "healthy"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "uptime": {
                      "type": "string",
                      "example": "3600s"
                    },
                    "database": {
                      "type": "object",
                      "properties": {
                        "status": {
                          "type": "string",
                          "example": "connected"
                        },
                        "name": {
                          "type": "string",
                          "example": "yisu_db"
                        }
                      }
                    },
                    "memory": {
                      "type": "object",
                      "properties": {
                        "heapUsed": {
                          "type": "string",
                          "example": "50MB"
                        },
                        "heapTotal": {
                          "type": "string",
                          "example": "100MB"
                        },
                        "rss": {
                          "type": "string",
                          "example": "150MB"
                        }
                      }
                    },
                    "node": {
                      "type": "object",
                      "properties": {
                        "version": {
                          "type": "string",
                          "example": "v18.17.0"
                        },
                        "env": {
                          "type": "string",
                          "example": "production"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "503": {
            "description": "系统不健康 (数据库未连接)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "unhealthy"
                    },
                    "database": {
                      "type": "object",
                      "properties": {
                        "status": {
                          "type": "string",
                          "example": "disconnected"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/register": {
      "post": {
        "summary": "用户注册",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "username",
                  "password",
                  "captchaToken"
                ],
                "properties": {
                  "username": {
                    "type": "string",
                    "example": "merchant_01"
                  },
                  "password": {
                    "type": "string",
                    "example": "123456"
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "user",
                      "merchant",
                      "admin"
                    ],
                    "default": "user"
                  },
                  "captchaToken": {
                    "type": "string",
                    "description": "滑块验证码验证通过后获取的 token",
                    "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  },
                  "gender": {
                    "type": "string",
                    "enum": [
                      "male",
                      "female",
                      "unknown"
                    ]
                  },
                  "bio": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "注册成功"
          },
          "400": {
            "description": "账号已存在"
          }
        }
      }
    },
    "/api/captcha/generate": {
      "get": {
        "summary": "生成滑块验证码",
        "description": "生成拼图滑块验证码，返回背景图片、拼图块图片和验证码ID",
        "tags": [
          "Captcha"
        ],
        "responses": {
          "200": {
            "description": "验证码生成成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "captchaId": {
                      "type": "string",
                      "description": "验证码唯一标识",
                      "example": "a1b2c3d4e5f6..."
                    },
                    "bgImage": {
                      "type": "string",
                      "description": "背景图片 (base64 PNG)"
                    },
                    "pieceImage": {
                      "type": "string",
                      "description": "拼图块图片 (base64 PNG)"
                    },
                    "y": {
                      "type": "integer",
                      "description": "拼图块的 Y 坐标位置",
                      "example": 42
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "验证码生成失败"
          }
        }
      }
    },
    "/api/captcha/verify": {
      "post": {
        "summary": "验证滑块验证码",
        "description": "验证用户拖动滑块的位置是否正确，正确则返回 captchaToken",
        "tags": [
          "Captcha"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "captchaId",
                  "x"
                ],
                "properties": {
                  "captchaId": {
                    "type": "string",
                    "description": "验证码ID",
                    "example": "a1b2c3d4e5f6..."
                  },
                  "x": {
                    "type": "number",
                    "description": "用户拖动到的 X 坐标位置",
                    "example": 156
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "验证结果",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "captchaToken": {
                      "type": "string",
                      "description": "验证通过后的 JWT token (仅成功时返回)"
                    },
                    "msg": {
                      "type": "string",
                      "description": "失败原因 (仅失败时返回)"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数缺失或验证码已过期"
          }
        }
      }
    },
    "/api/auth/login": {
      "post": {
        "summary": "用户登录",
        "tags": [
          "Auth"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "username",
                  "password"
                ],
                "properties": {
                  "username": {
                    "type": "string",
                    "example": "merchant_01"
                  },
                  "password": {
                    "type": "string",
                    "example": "123456"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "登录成功，返回 Token",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "token": {
                      "type": "string"
                    },
                    "user": {
                      "$ref": "#/components/schemas/User"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/users/profile": {
      "get": {
        "summary": "获取个人详细资料",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "修改个人资料 (头像/性别/简介)",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "avatar": {
                    "type": "string",
                    "example": "/uploads/new-avatar.jpg"
                  },
                  "gender": {
                    "type": "string",
                    "enum": [
                      "male",
                      "female",
                      "unknown"
                    ]
                  },
                  "bio": {
                    "type": "string",
                    "example": "这个人很懒，什么都没写"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "修改成功"
          }
        }
      }
    },
    "/api/banners": {
      "get": {
        "summary": "获取首页轮播图 (公开)",
        "tags": [
          "Banners"
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Banner"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "添加轮播图 (仅管理员)",
        "tags": [
          "Banners"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Banner"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "创建成功"
          },
          "403": {
            "description": "权限不足"
          }
        }
      }
    },
    "/api/banners/{id}": {
      "put": {
        "summary": "更新轮播图 (仅管理员)",
        "tags": [
          "Banners"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string",
                    "example": "五一特惠"
                  },
                  "imageUrl": {
                    "type": "string",
                    "example": "/uploads/banner1.jpg"
                  },
                  "sort": {
                    "type": "integer",
                    "example": 10
                  },
                  "isActive": {
                    "type": "boolean",
                    "example": true
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "_id": {
                      "type": "string"
                    },
                    "title": {
                      "type": "string"
                    },
                    "imageUrl": {
                      "type": "string"
                    },
                    "sort": {
                      "type": "integer"
                    },
                    "isActive": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "权限不足"
          },
          "404": {
            "description": "轮播图不存在"
          }
        }
      },
      "delete": {
        "summary": "删除轮播图 (仅管理员)",
        "tags": [
          "Banners"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          }
        }
      }
    },
    "/api/banners/admin/list": {
      "get": {
        "summary": "获取所有轮播图列表 (仅管理员)",
        "description": "获取所有轮播图（包括下线的），用于管理后台",
        "tags": [
          "Banners"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "_id": {
                        "type": "string"
                      },
                      "title": {
                        "type": "string"
                      },
                      "imageUrl": {
                        "type": "string"
                      },
                      "link": {
                        "type": "string"
                      },
                      "sort": {
                        "type": "integer"
                      },
                      "isActive": {
                        "type": "boolean"
                      },
                      "createdAt": {
                        "type": "string",
                        "format": "date-time"
                      }
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "权限不足"
          }
        }
      }
    },
    "/api/reviews": {
      "post": {
        "summary": "发布评价",
        "tags": [
          "Reviews"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "description": "评价发布后，会自动重新计算并更新酒店的总评分",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "hotelId",
                  "rating",
                  "content"
                ],
                "properties": {
                  "hotelId": {
                    "type": "string"
                  },
                  "rating": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 5,
                    "description": "1-5分"
                  },
                  "content": {
                    "type": "string",
                    "example": "房间很干净，服务很好！"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "评价成功"
          },
          "400": {
            "description": "已评价过"
          }
        }
      }
    },
    "/api/reviews/{hotelId}": {
      "get": {
        "summary": "获取某酒店的所有评价",
        "tags": [
          "Reviews"
        ],
        "parameters": [
          {
            "name": "hotelId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Review"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/upload": {
      "post": {
        "summary": "上传图片",
        "tags": [
          "Upload"
        ],
        "description": "上传单个文件，成功后返回相对路径",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "上传成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "msg": {
                      "type": "string"
                    },
                    "url": {
                      "type": "string",
                      "example": "/uploads/1709...jpg"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/hotels": {
      "post": {
        "summary": "发布新酒店 (仅商户)",
        "tags": [
          "Hotels"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Hotel"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "发布成功"
          },
          "403": {
            "description": "权限不足"
          }
        }
      },
      "get": {
        "summary": "首页搜索酒店 (公共)",
        "tags": [
          "Hotels"
        ],
        "parameters": [
          {
            "name": "city",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "城市筛选 (如: 上海)"
          },
          {
            "name": "keyword",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "名称或地址关键字"
          },
          {
            "name": "starRating",
            "in": "query",
            "schema": {
              "type": "integer"
            },
            "description": "星级 (1-5)"
          },
          {
            "name": "minPrice",
            "in": "query",
            "schema": {
              "type": "number"
            },
            "description": "最低价"
          },
          {
            "name": "maxPrice",
            "in": "query",
            "schema": {
              "type": "number"
            },
            "description": "最高价"
          },
          {
            "name": "sortType",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "default",
                "price_asc",
                "price_desc",
                "score_desc",
                "distance"
              ]
            },
            "description": "排序方式"
          },
          {
            "name": "tags",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "快捷标签筛选，多个标签用逗号分隔 (如: 亲子,免费停车)"
          },
          {
            "name": "checkInDate",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            },
            "description": "入住日期 (用于筛选有房酒店)",
            "example": "2026-05-01"
          },
          {
            "name": "checkOutDate",
            "in": "query",
            "schema": {
              "type": "string",
              "format": "date"
            },
            "description": "离店日期 (用于筛选有房酒店)",
            "example": "2026-05-03"
          },
          {
            "name": "userLat",
            "in": "query",
            "schema": {
              "type": "number"
            },
            "description": "用户当前纬度 (用于距离排序)"
          },
          {
            "name": "userLng",
            "in": "query",
            "schema": {
              "type": "number"
            },
            "description": "用户当前经度 (用于距离排序)"
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1
            },
            "description": "页码"
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10
            },
            "description": "每页条数"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Hotel"
                      }
                    },
                    "pagination": {
                      "type": "object",
                      "properties": {
                        "total": {
                          "type": "integer"
                        },
                        "page": {
                          "type": "integer"
                        },
                        "limit": {
                          "type": "integer"
                        },
                        "totalPages": {
                          "type": "integer"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/hotels/my": {
      "get": {
        "summary": "获取我的酒店列表 (仅商户)",
        "tags": [
          "Hotels"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Hotel"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/hotels/admin/list": {
      "get": {
        "summary": "获取所有酒店列表 (仅管理员)",
        "tags": [
          "Hotels"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Hotel"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/hotels/{id}": {
      "get": {
        "summary": "获取酒店详情",
        "tags": [
          "Hotels"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Hotel"
                }
              }
            }
          },
          "404": {
            "description": "未找到酒店"
          }
        }
      },
      "put": {
        "summary": "修改酒店信息 (仅商户)",
        "tags": [
          "Hotels"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Hotel"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "修改成功"
          }
        }
      }
    },
    "/api/hotels/{id}/audit": {
      "put": {
        "summary": "审核酒店 (仅管理员)",
        "tags": [
          "Hotels"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "integer",
                    "description": "1:通过, 2:拒绝"
                  },
                  "rejectReason": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "操作成功"
          }
        }
      }
    },
    "/api/hotels/{id}/status": {
      "put": {
        "summary": "酒店上下线 (商户/管理员)",
        "tags": [
          "Hotels"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "integer",
                    "description": "1:上线, 3:下线"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "操作成功"
          }
        }
      }
    },
    "/api/rooms": {
      "post": {
        "summary": "添加房型 (仅商户)",
        "tags": [
          "Rooms"
        ],
        "description": "添加后会自动更新酒店的最低价(minPrice)",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RoomType"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "添加成功"
          },
          "401": {
            "description": "无权操作"
          }
        }
      }
    },
    "/api/rooms/{hotelId}": {
      "get": {
        "summary": "获取某酒店的所有房型",
        "tags": [
          "Rooms"
        ],
        "description": "公共接口，用于详情页展示，按价格从低到高排序",
        "parameters": [
          {
            "name": "hotelId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/RoomType"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/rooms/{id}": {
      "put": {
        "summary": "修改房型信息 (仅商户)",
        "tags": [
          "Rooms"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "price": {
                    "type": "number"
                  },
                  "originalPrice": {
                    "type": "number"
                  },
                  "stock": {
                    "type": "integer"
                  },
                  "capacity": {
                    "type": "integer"
                  },
                  "bedInfo": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "images": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "修改成功"
          }
        }
      },
      "delete": {
        "summary": "删除房型 (仅商户)",
        "tags": [
          "Rooms"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          }
        }
      }
    },
    "/api/rooms/{id}/calendar": {
      "get": {
        "summary": "获取房型价格日历",
        "tags": [
          "Rooms"
        ],
        "description": "返回基础价格和特殊日期价格列表",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "basePrice": {
                      "type": "number"
                    },
                    "calendar": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "date": {
                            "type": "string"
                          },
                          "price": {
                            "type": "number"
                          },
                          "stock": {
                            "type": "integer"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "设置/更新价格日历 (仅商户)",
        "tags": [
          "Rooms"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "calendarData"
                ],
                "properties": {
                  "calendarData": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "required": [
                        "date",
                        "price"
                      ],
                      "properties": {
                        "date": {
                          "type": "string",
                          "example": "2026-10-01"
                        },
                        "price": {
                          "type": "number",
                          "example": 999
                        },
                        "stock": {
                          "type": "integer",
                          "example": 5
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功"
          }
        }
      }
    },
    "/api/orders": {
      "post": {
        "summary": "创建订单",
        "tags": [
          "Orders"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "hotelId",
                  "roomTypeId",
                  "checkInDate",
                  "checkOutDate"
                ],
                "properties": {
                  "hotelId": {
                    "type": "string"
                  },
                  "roomTypeId": {
                    "type": "string"
                  },
                  "checkInDate": {
                    "type": "string",
                    "format": "date"
                  },
                  "checkOutDate": {
                    "type": "string",
                    "format": "date"
                  },
                  "quantity": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "下单成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Order"
                }
              }
            }
          },
          "400": {
            "description": "参数错误"
          }
        }
      }
    },
    "/api/orders/my": {
      "get": {
        "summary": "获取我的订单列表",
        "tags": [
          "Orders"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Order"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/orders/{id}/cancel": {
      "put": {
        "summary": "取消订单",
        "tags": [
          "Orders"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "取消成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Order"
                }
              }
            }
          }
        }
      }
    },
    "/api/favorites": {
      "get": {
        "summary": "获取我的收藏列表",
        "tags": [
          "Favorites"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Favorite"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/favorites/{hotelId}": {
      "post": {
        "summary": "收藏酒店",
        "tags": [
          "Favorites"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "hotelId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "收藏成功"
          },
          "400": {
            "description": "已收藏过"
          }
        }
      },
      "delete": {
        "summary": "取消收藏",
        "tags": [
          "Favorites"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "hotelId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "取消成功"
          }
        }
      }
    },
    "/api/favorites/check/{hotelId}": {
      "get": {
        "summary": "检查是否已收藏 (用于前端UI状态)",
        "tags": [
          "Favorites"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "hotelId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "isFavorite": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/announcements": {
      "get": {
        "summary": "获取上线公告列表",
        "tags": [
          "Announcements"
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Announcement"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "创建公告 (管理员)",
        "tags": [
          "Announcements"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "title",
                  "content"
                ],
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "content": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "info",
                      "success",
                      "warning"
                    ]
                  },
                  "status": {
                    "type": "integer",
                    "enum": [
                      0,
                      1
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "创建成功"
          },
          "403": {
            "description": "权限不足"
          }
        }
      }
    },
    "/api/announcements/admin/list": {
      "get": {
        "summary": "获取所有公告列表 (管理员)",
        "tags": [
          "Announcements"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Announcement"
                  }
                }
              }
            }
          },
          "403": {
            "description": "权限不足"
          }
        }
      }
    },
    "/api/announcements/{id}": {
      "get": {
        "summary": "获取公告详情",
        "tags": [
          "Announcements"
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Announcement"
                }
              }
            }
          },
          "404": {
            "description": "公告不存在"
          }
        }
      },
      "put": {
        "summary": "更新公告 (管理员)",
        "tags": [
          "Announcements"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "content": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "info",
                      "success",
                      "warning"
                    ]
                  },
                  "status": {
                    "type": "integer",
                    "enum": [
                      0,
                      1
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功"
          },
          "403": {
            "description": "权限不足"
          },
          "404": {
            "description": "公告不存在"
          }
        }
      },
      "delete": {
        "summary": "删除公告 (管理员)",
        "tags": [
          "Announcements"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          },
          "403": {
            "description": "权限不足"
          },
          "404": {
            "description": "公告不存在"
          }
        }
      }
    },
    "/api/orders/{id}": {
      "get": {
        "summary": "获取订单详情",
        "tags": [
          "Orders"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "订单ID"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Order"
                }
              }
            }
          },
          "403": {
            "description": "无权查看此订单"
          },
          "404": {
            "description": "订单不存在"
          }
        }
      }
    },
    "/api/reviews/merchant/all": {
      "get": {
        "summary": "商户获取所有评价",
        "description": "获取该商户所有酒店的评价列表",
        "tags": [
          "Reviews"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "_id": {
                        "type": "string"
                      },
                      "userId": {
                        "type": "object",
                        "properties": {
                          "_id": {
                            "type": "string"
                          },
                          "username": {
                            "type": "string"
                          },
                          "avatar": {
                            "type": "string"
                          }
                        }
                      },
                      "hotelId": {
                        "type": "object",
                        "properties": {
                          "_id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "city": {
                            "type": "string"
                          }
                        }
                      },
                      "rating": {
                        "type": "integer",
                        "minimum": 1,
                        "maximum": 5
                      },
                      "content": {
                        "type": "string"
                      },
                      "createdAt": {
                        "type": "string",
                        "format": "date-time"
                      }
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "权限不足"
          }
        }
      }
    },
    "/api/users/password": {
      "put": {
        "summary": "修改密码",
        "tags": [
          "Users"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "oldPassword",
                  "newPassword"
                ],
                "properties": {
                  "oldPassword": {
                    "type": "string",
                    "description": "当前密码"
                  },
                  "newPassword": {
                    "type": "string",
                    "description": "新密码",
                    "minLength": 6
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "密码修改成功"
          },
          "400": {
            "description": "原密码错误或新密码不符合要求"
          }
        }
      }
    },
    "/api/messages/conversations": {
      "get": {
        "summary": "获取会话列表",
        "description": "获取当前用户的所有聊天会话，包含最后一条消息和未读数",
        "tags": [
          "Messages"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "会话列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "conversationId": {
                        "type": "string"
                      },
                      "otherUser": {
                        "$ref": "#/components/schemas/User"
                      },
                      "lastMessage": {
                        "$ref": "#/components/schemas/Message"
                      },
                      "unreadCount": {
                        "type": "integer"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/messages/contacts": {
      "get": {
        "summary": "获取可联系用户列表",
        "description": "商户获取有订单关系的用户，用户获取有订单关系的商户",
        "tags": [
          "Messages"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "联系人列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "user": {
                        "$ref": "#/components/schemas/User"
                      },
                      "hotel": {
                        "type": "object",
                        "properties": {
                          "_id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          }
                        }
                      },
                      "lastOrderDate": {
                        "type": "string",
                        "format": "date-time"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/messages/unread/count": {
      "get": {
        "summary": "获取未读消息数",
        "description": "获取当前用户的未读消息总数",
        "tags": [
          "Messages"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "未读数",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "count": {
                      "type": "integer",
                      "example": 5
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/messages/{userId}": {
      "get": {
        "summary": "获取聊天记录",
        "description": "获取与指定用户的聊天消息历史",
        "tags": [
          "Messages"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "对方用户ID"
          }
        ],
        "responses": {
          "200": {
            "description": "消息列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Message"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/messages": {
      "post": {
        "summary": "发送消息",
        "description": "向指定用户发送消息，商户只能联系有订单的用户",
        "tags": [
          "Messages"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "receiverId",
                  "content"
                ],
                "properties": {
                  "receiverId": {
                    "type": "string",
                    "description": "接收者用户ID"
                  },
                  "content": {
                    "type": "string",
                    "description": "消息内容"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "text",
                      "image"
                    ],
                    "default": "text"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "消息发送成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Message"
                }
              }
            }
          },
          "400": {
            "description": "接收者和消息内容不能为空"
          },
          "403": {
            "description": "商户只能联系有订单的用户"
          }
        }
      }
    },
    "/api/promotions/hotel/{hotelId}": {
      "get": {
        "summary": "获取酒店促销列表",
        "description": "获取指定酒店当前有效的促销活动",
        "tags": [
          "Promotions"
        ],
        "parameters": [
          {
            "name": "hotelId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "酒店ID"
          }
        ],
        "responses": {
          "200": {
            "description": "促销列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Promotion"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/promotions/my": {
      "get": {
        "summary": "获取我的促销列表",
        "description": "商户获取自己所有酒店的促销活动",
        "tags": [
          "Promotions"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "促销列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Promotion"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/promotions": {
      "post": {
        "summary": "创建促销活动",
        "description": "商户创建新的促销活动",
        "tags": [
          "Promotions"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "hotelId",
                  "title",
                  "type",
                  "discountValue",
                  "startDate",
                  "endDate"
                ],
                "properties": {
                  "hotelId": {
                    "type": "string"
                  },
                  "title": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "discount",
                      "amount_off",
                      "fixed_price"
                    ]
                  },
                  "discountValue": {
                    "type": "number"
                  },
                  "minAmount": {
                    "type": "number"
                  },
                  "roomTypes": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "startDate": {
                    "type": "string",
                    "format": "date"
                  },
                  "endDate": {
                    "type": "string",
                    "format": "date"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "促销创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Promotion"
                }
              }
            }
          },
          "400": {
            "description": "参数错误"
          },
          "403": {
            "description": "权限不足"
          }
        }
      }
    },
    "/api/promotions/{id}": {
      "put": {
        "summary": "更新促销活动",
        "description": "商户更新促销活动信息",
        "tags": [
          "Promotions"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string"
                  },
                  "discountValue": {
                    "type": "number"
                  },
                  "minAmount": {
                    "type": "number"
                  },
                  "roomTypes": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "startDate": {
                    "type": "string"
                  },
                  "endDate": {
                    "type": "string"
                  },
                  "status": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功"
          },
          "403": {
            "description": "权限不足"
          },
          "404": {
            "description": "促销不存在"
          }
        }
      },
      "delete": {
        "summary": "删除促销活动",
        "description": "商户删除促销活动",
        "tags": [
          "Promotions"
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          },
          "403": {
            "description": "权限不足"
          },
          "404": {
            "description": "促销不存在"
          }
        }
      }
    }
  }
}